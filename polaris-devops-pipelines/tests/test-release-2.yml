---
trigger: none
pr: none

variables:
  - group: kv-dev-terraform
  - group: polaris-global
  - group: polaris-status-check-endpoints
  - group: terraform-containers

stages:
  # DEV: BEGIN DEPLOYMENT, TERRAFORM AND THEN CODEBASE, IF CHANGES FOUND  
  - stage: Deploy
    displayName: Test Deploy
    pool:
      name: $(dev-build-agent)
    jobs:
      - deployment: Deploy_Text_Extractor
        dependsOn: Start_Pipeline_Slots
        displayName: Deploy Text Extractor
        environment: "Dev"
        strategy:
          runOnce:
            deploy:
              steps:
                # download scripts artifact
                - download: $(target_build)
                  displayName: Download Scripts
                  artifact: 'polaris-script-files'
                
                # download text-extractor build artifact
                - download: $(target_build)
                  displayName: Deploy > Download Text Extractor Codebase Build
                  artifact: "polaris-text-extractor-drop"
