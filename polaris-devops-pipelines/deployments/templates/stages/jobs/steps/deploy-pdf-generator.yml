parameters:
  buildLabel: ""
  appInsightsKey: ""
  envLabel: ""
  envSuffix: ""
  azureSubscription: ""

steps:
  #send custom event to AppInsights
- template: tasks/send-to-app-insights.yml
  parameters:
    appInsightsKey: "${{ parameters.appInsightsKey }}"
    message: "${{ parameters.envLabel }} Pipeline Component Deployment: Publish Pdf Generator - Started"

  #download pdf-generator build artifact
- download: ${{ parameters.buildLabel }}
  displayName: Deploy > Download PDF Generator Codebase Build
  artifact: "polaris-pdf-generator-drop"

  # Deploy Related Codebase to Env
- task: AzureFunctionApp@1
  displayName: 'Deploy PDF Generator Azure Function App to ${{ parameters.envLabel }}'
  inputs:
    azureSubscription: "${{ parameters.azureSubscription }}"
    appType: functionApp
    appName: "fa-polaris-pipeline${{ parameters.envSuffix }}-pdf-generator"
    package: $(Pipeline.Workspace)/${{ parameters.buildLabel }}/polaris-pdf-generator-drop

  #send custom event to AppInsights
- template: tasks/send-to-app-insights.yml
  parameters:
    appInsightsKey: "${{ parameters.appInsightsKey }}"
    message: "${{ parameters.envLabel }} Pipeline Component Deployment: Publish Pdf Generator - Completed"