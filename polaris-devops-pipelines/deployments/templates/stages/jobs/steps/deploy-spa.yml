parameters:
  buildLabel: ""
  appInsightsKey: ""
  envLabel: ""
  envSuffix: ""
  azureSubscription: ""
  
steps:
#send custom event to AppInsights
- template: tasks/send-to-app-insights.yml
  parameters:
    appInsightsKey: "${{ parameters.appInsightsKey }}"
    message: "${{ parameters.envLabel }} UI Component Deployment: Publish SPA - Started"
  
  #download UI build artifact
- download: ${{ parameters.buildLabel }}
  displayName: Deploy > Download SPA Codebase Build
  artifact: "polaris-ui-drop"
  
  #Deploy Related Codebase to Env
- task: AzureRmWebAppDeployment@4
  displayName: 'Deploy SPA App Service to ${{ parameters.envLabel }}'
  inputs:
    azureSubscription: "${{ parameters.azureSubscription }}"
    appType: webAppLinux
    WebAppName: "as-web-polaris${{ parameters.envSuffix }}"
    packageForLinux: $(Pipeline.Workspace)/${{ parameters.buildLabel }}/polaris-ui-drop
  
  #send custom event to AppInsights
- template: tasks/send-to-app-insights.yml
  parameters:
    appInsightsKey: "${{ parameters.appInsightsKey }}"
    message: "${{ parameters.envLabel }} UI Component Deployment: Publish SPA - Completed"