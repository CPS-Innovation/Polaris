{"file":"cps-global-nav.entry.esm.js","mappings":"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","names":[],"sources":["src/context/LocationConfig.ts","src/context/get-location-config.ts","src/components/cps-global-nav/cps-global-nav.scss?tag=cps-global-nav&encapsulation=shadow","src/components/cps-global-nav/cps-global-nav.tsx"],"sourcesContent":["export type LinkCode = \"tasks\" | \"cases\" | \"details\" | \"case-materials\" | \"bulk-um-classification\" | \"review\";\n\nexport type OnwardLinkDefinitions = Partial<{ [key in LinkCode]: string }>;\n\nexport type PathMatcher = { paths: string[]; matchedLinkCode: LinkCode; showSecondRow: boolean; onwardLinks: OnwardLinkDefinitions };\n\nexport type MatchedPathMatcher = Omit<PathMatcher, \"paths\"> & {\n  pathTags?: { [key: string]: string };\n};\n\nexport type AppLocationConfig = {\n  pathRoots: string[];\n  pathMatchers: PathMatcher[];\n};\n\nexport const appLocationConfigs: AppLocationConfig[] = [\n  {\n    pathRoots: [\"https://polaris-dev-notprod.cps.gov.uk/polaris-ui\", \"https://polaris-dev-cmsproxy.azurewebsites.net/polaris-ui\", \"http://localhost:3000/polaris-ui\"],\n    pathMatchers: [\n      {\n        paths: [\"/polaris-ui/case-details/(?<urn>[^/+])/(?<caseId>[^d+])\"],\n        matchedLinkCode: \"case-materials\",\n        showSecondRow: true,\n        onwardLinks: { tasks: \"https://cps-dev.outsystemsenterprise.com/WorkManagementApp/TaskList\", cases: \"https://cps-dev.outsystemsenterprise.com/WorkManagementApp/TaskList\" },\n      },\n      {\n        paths: [\"/polaris-ui/\", \"/polaris-ui\"],\n        matchedLinkCode: \"case-materials\",\n        showSecondRow: false,\n        onwardLinks: { tasks: \"https://cps-dev.outsystemsenterprise.com/WorkManagementApp/TaskList\", cases: \"https://cps-dev.outsystemsenterprise.com/WorkManagementApp/TaskList\" },\n      },\n    ],\n  },\n  {\n    pathRoots: [\"http://localhost:3333\"],\n    pathMatchers: [\n      {\n        paths: [\"/urns/(?<urn>[^/]+)/cases/(?<caseId>[^/]+)\"],\n        matchedLinkCode: \"tasks\",\n        showSecondRow: true,\n        onwardLinks: { tasks: \"http://localhost:3333/?urn={urn}&caseId={caseId}\", cases: \"http://localhost:3333/?urn={urn}&caseId={caseId}\" },\n      },\n      {\n        paths: [\"/\", \"\"],\n        matchedLinkCode: \"tasks\",\n        showSecondRow: false,\n        onwardLinks: { tasks: \"http://localhost:3333/urns/12AB121212/cases/11112222\", cases: \"http://localhost:3333/urns/34AB343434/cases/333344444\" },\n      },\n    ],\n  },\n];\n","import { AppLocationConfig, appLocationConfigs, MatchedPathMatcher, OnwardLinkDefinitions, PathMatcher } from \"./LocationConfig\";\n\nconst flattenConfig = (appLocationConfigs: AppLocationConfig[]) => {\n  const result = [] as {\n    pathRoot: string;\n    path: string;\n    pathMatcherValues: Omit<PathMatcher, \"paths\">;\n  }[];\n\n  for (const appLocationConfig of appLocationConfigs) {\n    for (const pathRoot of appLocationConfig.pathRoots) {\n      for (const { paths, ...pathMatcherValues } of appLocationConfig.pathMatchers) {\n        for (const path of paths) {\n          result.push({\n            pathRoot,\n            path,\n            pathMatcherValues,\n          });\n        }\n      }\n    }\n  }\n  return result;\n};\n\nconst isPathMatch = ({ pathRoot, path }: ReturnType<typeof flattenConfig>[0], { href, pathname, search }: Location) => {\n  const result = href.startsWith(pathRoot) && !!(pathname + search).match(path);\n  console.debug(`Matching ${pathname + search} against ${pathRoot} -> ${path}: result ${result}`);\n  return result;\n};\n\nconst replaceTags = (source: string, pathTags: MatchedPathMatcher[\"pathTags\"]) =>\n  Object.keys(pathTags).reduce((acc, curr) => {\n    const tag = `{${curr}}`;\n    console.debug(`Replacing ${tag} in ${acc} with ${pathTags[curr]}`);\n    return acc.replace(new RegExp(tag, \"g\"), pathTags[curr]);\n  }, source);\n\nconst replaceTagsInOnwardLinks = (linkDefinitions: OnwardLinkDefinitions, pathTags: MatchedPathMatcher[\"pathTags\"]) => {\n  if (!pathTags || !Object.keys(pathTags).length) {\n    return linkDefinitions;\n  }\n  return Object.keys(linkDefinitions).reduce((acc, curr) => {\n    acc[curr] = replaceTags(linkDefinitions[curr], pathTags);\n    return acc;\n  }, {} as OnwardLinkDefinitions);\n};\n\nexport const getLocationConfig = ({ location: { pathname, search } }: Window): MatchedPathMatcher => {\n  const flatConfigs = flattenConfig(appLocationConfigs);\n  const config = flatConfigs.find(config => isPathMatch(config, location));\n  if (!config) {\n    return null;\n  }\n\n  const {\n    path,\n    pathMatcherValues: { onwardLinks, ...rest },\n  } = config;\n  const pathTags = (pathname + search).match(path).groups;\n\n  return {\n    pathTags,\n    onwardLinks: replaceTagsInOnwardLinks(onwardLinks, pathTags),\n    ...rest,\n  };\n};\n","@import \"node_modules/govuk-frontend/dist/govuk/index\";\n$level-height: 3rem;\n\n:host {\n  display: block;\n}\n\na.govuk-link {\n  color: $govuk-brand-colour;\n  @include govuk-font($size: 19);\n  text-decoration: none;\n\n  &:visited {\n    color: $govuk-brand-colour;\n  }\n}\n\n.background {\n  box-shadow: 0 0 0 100vmax govuk-colour(\"light-grey\");\n  clip-path: inset(0 -100vmax);\n  background-color: govuk-colour(\"light-grey\");\n}\n\n.background-divider {\n  height: 1px;\n  box-shadow: 0 0 0 100vmax $govuk-border-colour;\n  clip-path: inset(0 -100vmax);\n  background-color: $govuk-border-colour;\n  z-index: -1;\n}\n\n.background-left-only {\n  background-color: govuk-colour(\"light-grey\");\n  position: relative;\n  display: grid;\n}\n\n.background-left-only:before {\n  content: \"\";\n  background-color: govuk-colour(\"light-grey\");\n  position: absolute;\n  height: 100%;\n  width: 100vw;\n  left: -100vw;\n}\n\n@mixin horizontal-list {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n  height: $level-height;\n  display: flex;\n  align-items: center;\n  & > li {\n    float: left;\n    box-sizing: border-box;\n  }\n}\n\n.level-1 {\n  height: $level-height;\n  display: flex;\n  align-items: center;\n  ul {\n    @include horizontal-list();\n    li {\n      margin: 0 1.8rem 0 0;\n      a {\n        font-weight: bold;\n      }\n    }\n  }\n}\n\n$arrow-length: $level-height/2;\n\n.level-2 {\n  height: $level-height;\n  display: flex;\n  align-items: center;\n  background-color: govuk-colour(\"white\");\n\n  div:first-child {\n    @include govuk-font($size: 19);\n    font-weight: bold;\n    background-color: govuk-colour(\"light-grey\");\n    display: flex;\n    align-items: center;\n    height: $level-height;\n\n    .name {\n      display: block;\n      //min-width: 12rem;\n    }\n\n    &:after {\n      content: \"\";\n      background-color: govuk-colour(\"white\");\n      display: inline-block;\n      border-left: $arrow-length solid govuk-colour(\"light-grey\");\n      border-bottom: $arrow-length solid transparent;\n      border-top: $arrow-length solid transparent;\n    }\n\n    &.please-wait {\n      color: govuk-colour(\"dark-grey\");\n    }\n  }\n\n  & > ul {\n    @include horizontal-list();\n    margin-left: 1rem;\n\n    li {\n      margin: 0 1.8rem 0 0;\n    }\n  }\n\n  .slot-container {\n    margin-left: auto;\n  }\n\n  ul:last-child {\n    li {\n      margin-right: 0;\n    }\n  }\n}\n\n.dropdown {\n  padding-right: 25px !important;\n\n  &:after {\n    left: inherit;\n    right: 0;\n    top: 10px;\n    content: \"\";\n    width: 0;\n    height: 0;\n    border-left: 8px solid transparent;\n    border-right: 8px solid transparent;\n    border-top: 8px solid #1d70b8;\n    position: absolute;\n  }\n\n  ul {\n    display: none;\n  }\n}\n\n.dropdown.active {\n  &:after {\n    transform: rotate(180deg);\n  }\n\n  ul {\n    display: block;\n    position: absolute !important;\n    top: 35px;\n    background: #f5f5f5;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    min-width: 250px;\n    box-shadow: 10px 10px 10px 10px rgba(0, 0, 0, 0.2);\n    border-top: 5px solid #1d70b8;\n\n    &.align-right {\n      right: 0;\n    }\n\n    li {\n      padding: 0 !important;\n      margin: 0 !important;\n      a {\n        display: inline-block;\n        width: 92%;\n        font-size: 1.3rem;\n        padding: 2% 4%;\n\n        &.disabled {\n          color: #b1b4b6;\n          pointer-events: none;\n          cursor: default;\n        }\n      }\n    }\n  }\n}\n\nul:has(.dropdown) {\n  @include horizontal-list();\n  margin-left: 1rem;\n  li {\n    position: relative;\n  }\n}\n\n.linkButton {\n  margin: 0.125rem;\n  display: inline;\n  background: transparent;\n  border-width: 0;\n  cursor: pointer;\n  font-size: 1.187rem;\n  width: fit-content;\n  color: #1d70b8;\n  @include govuk-font($size: 19);\n\n  &:focus {\n    color: #0b0c0c;\n    background-color: #ffdd00;\n    box-shadow: 0 0.25rem 0 #0b0c0c;\n    outline: 0.1875rem solid transparent;\n  }\n}\n","import { Component, Prop, h, Event, EventEmitter, State } from \"@stencil/core\";\nimport { getLocationConfig } from \"../../context/get-location-config\";\nimport { LinkCode, MatchedPathMatcher } from \"../../context/LocationConfig\";\n\n@Component({\n  tag: \"cps-global-nav\",\n  styleUrl: \"cps-global-nav.scss\",\n  shadow: true,\n})\nexport class CpsGlobalNav {\n  /**\n   * The text to appear at the start of the second row\n   */\n  @Prop() name: string;\n\n  @Prop() forceEnvironment: string;\n\n  @Event({\n    eventName: \"cpsGlobalNavEvent\",\n    composed: true,\n    cancelable: true,\n    bubbles: true,\n  })\n  cpsGlobalNavEvent: EventEmitter<string>;\n\n  @State() config: MatchedPathMatcher;\n\n  async componentWillLoad() {\n    this.config = getLocationConfig(window);\n  }\n\n  linkHelper = (code: LinkCode, label: string) => ({ label, href: this.config?.onwardLinks[code], selected: this.config?.matchedLinkCode === code });\n\n  emitWindowEvent() {\n    this.cpsGlobalNavEvent.emit(\"foo\");\n  }\n\n  render() {\n    return (\n      <div>\n        <div class=\"level-1 background\">\n          <ul>\n            <nav-link {...this.linkHelper(\"tasks\", \"Tasks\")}></nav-link>\n            <nav-link {...this.linkHelper(\"cases\", \"Cases\")}></nav-link>\n          </ul>\n        </div>\n        <div class=\"background-divider\"></div>\n\n        <div class=\"level-2 background-left-only\">\n          <div>\n            <span class=\"name\">{this.name}</span>\n          </div>\n          <ul>\n            <nav-link {...this.linkHelper(\"details\", \"Details\")}></nav-link>\n            <drop-down\n              label=\"Materials\"\n              links={[this.linkHelper(\"case-materials\", \"Case Materials\"), this.linkHelper(\"bulk-um-classification\", \"Bulk UM classification\")]}\n            ></drop-down>\n            <nav-link {...this.linkHelper(\"review\", \"Review\")}></nav-link>\n          </ul>\n          <div class=\"slot-container\">\n            <slot />\n          </div>\n          <ul>\n            <drop-down\n              label=\"CMS Classic\"\n              menuAlignment=\"right\"\n              links={[\n                { label: \"Task list\", href: \"/task-list\" },\n                { label: \"Cases\", href: \"/cases\" },\n                { label: \"Case review\", href: \"/case-review\" },\n                { label: \"Case materials\", href: \"/case-materials\" },\n                { label: \"Pre-charge triage\", href: \"/pre-charge-triage\" },\n              ]}\n            ></drop-down>\n          </ul>\n        </div>\n        <div class=\"background-divider\"></div>\n      </div>\n    );\n  }\n}\n"],"version":3}